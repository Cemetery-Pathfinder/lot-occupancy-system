"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=exports.los,s=document.querySelector("#form--searchFilters"),n=s.querySelector("#searchFilter--workOrderMilestoneDateFilter"),r=s.querySelector("#searchFilter--workOrderMilestoneDateString"),a=document.querySelector("#container--milestoneCalendar");function i(n){n&&n.preventDefault(),a.innerHTML=e.getLoadingParagraphHTML("Loading Milestones..."),cityssm.postJSON(`${e.urlPrefix}/workOrders/doGetWorkOrderMilestones`,s,s=>{!function(s){var n,r,i,t,l,o,c,d,p,u,m,v,M,f,O;if(0===s.length)return void(a.innerHTML='<div class="message is-info">\n        <p class="message-body">There are no milestones that meet the search criteria.</p>\n        </div>');a.innerHTML="";const k=cityssm.dateToString(new Date);let g,w="x";for(const y of s){w!==y.workOrderMilestoneDateString&&(g&&a.append(g),(g=document.createElement("div")).className="panel",g.innerHTML=`<h2 class="panel-heading">\n          ${cityssm.escapeHTML(0===y.workOrderMilestoneDate?"No Set Date":null!==(n=y.workOrderMilestoneDateString)&&void 0!==n?n:"")}\n          </h2>`,w=null!==(r=y.workOrderMilestoneDateString)&&void 0!==r?r:"");const s=document.createElement("div");s.className="panel-block is-block",!y.workOrderMilestoneCompletionDate&&""!==y.workOrderMilestoneDateString&&y.workOrderMilestoneDateString<k&&s.classList.add("has-background-warning-light");let L="";for(const s of null!==(i=y.workOrderLots)&&void 0!==i?i:[])L+=`<li class="has-tooltip-left"\n          data-tooltip="${cityssm.escapeHTML(null!==(t=s.mapName)&&void 0!==t?t:"")}">\n          <span class="fa-li">\n          <i class="fas fa-vector-square"\n            aria-label="${e.escapedAliases.Lot}"></i>\n          </span>\n          ${cityssm.escapeHTML(null!==(l=s.lotName)&&void 0!==l?l:"")}\n          </li>`;for(const s of null!==(o=y.workOrderLotOccupancies)&&void 0!==o?o:[])for(const n of null!==(c=s.lotOccupancyOccupants)&&void 0!==c?c:[])L+=`<li class="has-tooltip-left"\n            data-tooltip="${cityssm.escapeHTML(null!==(d=n.lotOccupantType)&&void 0!==d?d:"")}">\n            <span class="fa-li">\n            <i class="fas fa-user"\n              aria-label="${e.escapedAliases.Occupancy}"></i>\n            </span>\n            ${cityssm.escapeHTML(null!==(p=n.occupantName)&&void 0!==p?p:"")}\n            ${cityssm.escapeHTML(null!==(u=n.occupantFamilyName)&&void 0!==u?u:"")}\n            </li>`;s.innerHTML=`<div class="columns">\n        <div class="column is-narrow">\n          <span class="icon is-small">\n            ${y.workOrderMilestoneCompletionDate?'<i class="fas fa-check" aria-label="Completed"></i>':'<i class="far fa-square has-text-grey" aria-label="Incomplete"></i>'}\n          </span>\n        </div><div class="column">\n          ${0===y.workOrderMilestoneTime?"":`${y.workOrderMilestoneTimePeriodString}<br />`}\n          ${y.workOrderMilestoneTypeId?`<strong>${cityssm.escapeHTML(null!==(m=y.workOrderMilestoneType)&&void 0!==m?m:"")}</strong><br />`:""}\n          <span class="is-size-7">\n            ${cityssm.escapeHTML(null!==(v=y.workOrderMilestoneDescription)&&void 0!==v?v:"")}\n          </span>\n        </div><div class="column">\n          <i class="fas fa-circle" style="color:${e.getRandomColor(null!==(M=y.workOrderNumber)&&void 0!==M?M:"")}" aria-hidden="true"></i>\n          <a class="has-text-weight-bold" href="${e.getWorkOrderURL(y.workOrderId)}">\n            ${cityssm.escapeHTML(null!==(f=y.workOrderNumber)&&void 0!==f?f:"")}\n          </a><br />\n          <span class="is-size-7">${cityssm.escapeHTML(null!==(O=y.workOrderDescription)&&void 0!==O?O:"")}</span>\n        </div><div class="column is-size-7">\n          ${""===L?"":`<ul class="fa-ul ml-4">${L}</ul>`}</div></div>`,g.append(s)}a.append(g)}(s.workOrderMilestones)})}n.addEventListener("change",()=>{r.closest("fieldset").disabled="date"!==n.value,i()}),e.initializeDatePickers(s),r.addEventListener("change",i),s.addEventListener("submit",i),i()})();