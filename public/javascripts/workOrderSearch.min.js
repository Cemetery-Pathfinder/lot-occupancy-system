"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=exports.los,t=exports.workOrderPrints,s=document.querySelector("#form--searchFilters");e.initializeDatePickers(s);const a=document.querySelector("#container--searchResults"),n=Number.parseInt(document.querySelector("#searchFilter--limit").value,10),r=document.querySelector("#searchFilter--offset");function o(s){var r,o,l,i,u,p,f,m,h,v,O,k,$,b,w,y,g,L,M,N;const T=s;if(0===T.workOrders.length)return void(a.innerHTML='<div class="message is-info">\n        <p class="message-body">There are no work orders that meet the search criteria.</p>\n        </div>');const S=document.createElement("tbody");for(const s of T.workOrders){let a="";for(const t of null!==(r=s.workOrderLots)&&void 0!==r?r:[])a+=`<li class="has-tooltip-left"\n          data-tooltip="${cityssm.escapeHTML(null!==(o=t.mapName)&&void 0!==o?o:"")}">\n          <span class="fa-li">\n            <i class="fas fa-fw fa-vector-square"\n              aria-label="${e.escapedAliases.Lot}"></i>\n          </span>\n          ${cityssm.escapeHTML(""===(null!==(l=t.lotName)&&void 0!==l?l:"")?`(No ${e.escapedAliases.Lot} Name)`:null!==(i=t.lotName)&&void 0!==i?i:"")}\n          </li>`;for(const t of null!==(u=s.workOrderLotOccupancies)&&void 0!==u?u:[])for(const s of null!==(p=t.lotOccupancyOccupants)&&void 0!==p?p:[])a+=`<li class="has-tooltip-left"\n            data-tooltip="${cityssm.escapeHTML(null!==(f=s.lotOccupantType)&&void 0!==f?f:"")}">\n            <span class="fa-li">\n              <i class="fas fa-fw fa-${cityssm.escapeHTML(""===(null!==(m=s.fontAwesomeIconClass)&&void 0!==m?m:"")?"user":null!==(h=s.fontAwesomeIconClass)&&void 0!==h?h:"")}" aria-label="${e.escapedAliases.occupant}"></i>\n            </span>\n            ${cityssm.escapeHTML(""===(null!==(v=s.occupantName)&&void 0!==v?v:"")&&""===(null!==(O=s.occupantFamilyName)&&void 0!==O?O:"")?"(No Name)":`${s.occupantName} ${s.occupantFamilyName}`)}\n            </li>`;S.insertAdjacentHTML("beforeend",`<tr>\n          <td>\n            <a class="has-text-weight-bold" href="${e.getWorkOrderURL(s.workOrderId)}">\n              ${""===(null===(k=s.workOrderNumber)||void 0===k?void 0:k.trim())?"(No Number)":cityssm.escapeHTML(null!==($=s.workOrderNumber)&&void 0!==$?$:"")}\n            </a>\n          </td><td>\n            ${cityssm.escapeHTML(null!==(b=s.workOrderType)&&void 0!==b?b:"")}<br />\n            <span class="is-size-7">\n              ${cityssm.escapeHTML(null!==(w=s.workOrderDescription)&&void 0!==w?w:"")}\n            </span>\n          </td><td>\n            ${""===a?"":`<ul class="fa-ul ml-5 is-size-7">${a}</ul>`}\n          </td><td>\n            <ul class="fa-ul ml-5 is-size-7">\n              <li class="has-tooltip-left"\n                data-tooltip="${e.escapedAliases.WorkOrderOpenDate}">\n                <span class="fa-li">\n                  <i class="fas fa-fw fa-play" aria-label="${e.escapedAliases.WorkOrderOpenDate}"></i>\n                </span>\n                ${s.workOrderOpenDateString}\n              </li>\n              <li class="has-tooltip-left" data-tooltip="${e.escapedAliases.WorkOrderCloseDate}">\n                <span class="fa-li">\n                  <i class="fas fa-fw fa-stop" aria-label="${e.escapedAliases.WorkOrderCloseDate}"></i>\n                </span>\n                ${s.workOrderCloseDate?s.workOrderCloseDateString:`<span class="has-text-grey">(No ${e.escapedAliases.WorkOrderCloseDate})</span>`}\n              </li>\n            </ul>\n          </td><td>\n            ${0===s.workOrderMilestoneCount?"-":`${(null!==(y=s.workOrderMilestoneCompletionCount)&&void 0!==y?y:"").toString()}\n                  /\n                  ${(null!==(g=s.workOrderMilestoneCount)&&void 0!==g?g:"").toString()}`}\n          </td>\n          ${t.length>0?`<td>\n                  <a class="button is-small" data-tooltip="Print"\n                    href="${e.urlPrefix}/print/${t[0]}/?workOrderId=${s.workOrderId.toString()}"\n                    target="_blank">\n                    <i class="fas fa-print" aria-label="Print"></i>\n                  </a>\n                  </td>`:""}</tr>`)}a.innerHTML=`<table class="table is-fullwidth is-striped is-hoverable has-sticky-header">\n      <thead><tr>\n      <th>Work Order Number</th>\n      <th>Description</th>\n      <th>Related</th>\n      <th>Date</th>\n      <th class="has-tooltip-bottom" data-tooltip="Completed / Total Milestones">Progress</th>\n      ${t.length>0?'<th class="has-width-1"></th>':""}\n      </tr></thead>\n      <table>`,a.insertAdjacentHTML("beforeend",e.getSearchResultsPagerHTML(n,T.offset,T.count)),null===(L=a.querySelector("table"))||void 0===L||L.append(S),null===(M=a.querySelector("button[data-page='previous']"))||void 0===M||M.addEventListener("click",c),null===(N=a.querySelector("button[data-page='next']"))||void 0===N||N.addEventListener("click",d)}function l(){a.innerHTML=e.getLoadingParagraphHTML("Loading Work Orders..."),cityssm.postJSON(`${e.urlPrefix}/workOrders/doSearchWorkOrders`,s,o)}function i(){r.value="0",l()}function c(){r.value=Math.max(Number.parseInt(r.value,10)-n,0).toString(),l()}function d(){r.value=(Number.parseInt(r.value,10)+n).toString(),l()}const u=s.querySelectorAll("input, select");for(const e of u)e.addEventListener("change",i);s.addEventListener("submit",e=>{e.preventDefault()}),l()})();