"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e,t,n,c,o;const a=exports.los,l=document.querySelector("#lotOccupancy--lotOccupancyId").value,s=""===l;let i=s;function r(){var e;a.setUnsavedChanges(),null===(e=document.querySelector("button[type='submit'][form='form--lotOccupancy']"))||void 0===e||e.classList.remove("is-light")}function u(){var e;a.clearUnsavedChanges(),null===(e=document.querySelector("button[type='submit'][form='form--lotOccupancy']"))||void 0===e||e.classList.add("is-light")}const d=document.querySelector("#form--lotOccupancy");d.addEventListener("submit",e=>{e.preventDefault(),cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/${s?"doCreateLotOccupancy":"doUpdateLotOccupancy"}`,d,e=>{var t;const n=e;n.success?(u(),s||i?window.location.href=a.getLotOccupancyURL(n.lotOccupancyId,!0,!0):bulmaJS.alert({message:`${a.escapedAliases.Occupancy} Updated Successfully`,contextualColorName:"success"})):bulmaJS.alert({title:`Error Saving ${a.escapedAliases.Occupancy}`,message:null!==(t=n.errorMessage)&&void 0!==t?t:"",contextualColorName:"danger"})})});const p=d.querySelectorAll("input, select");for(const e of p)e.addEventListener("change",r);function m(){cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doCopyLotOccupancy`,{lotOccupancyId:l},e=>{var t;const n=e;n.success?(u(),window.location.href=a.getLotOccupancyURL(n.lotOccupancyId,!0)):bulmaJS.alert({title:"Error Copying Record",message:null!==(t=n.errorMessage)&&void 0!==t?t:"",contextualColorName:"danger"})})}null===(S=document.querySelector("#button--copyLotOccupancy"))||void 0===S||S.addEventListener("click",e=>{e.preventDefault(),a.hasUnsavedChanges()?bulmaJS.alert({title:"Unsaved Changes",message:"Please save all unsaved changes before continuing.",contextualColorName:"warning"}):bulmaJS.confirm({title:`Copy ${a.escapedAliases.Occupancy} Record as New`,message:"Are you sure you want to copy this record to a new record?",contextualColorName:"info",okButton:{text:"Yes, Copy",callbackFunction:m}})}),null===(e=document.querySelector("#button--deleteLotOccupancy"))||void 0===e||e.addEventListener("click",e=>{e.preventDefault(),bulmaJS.confirm({title:`Delete ${a.escapedAliases.Occupancy} Record`,message:"Are you sure you want to delete this record?",contextualColorName:"warning",okButton:{text:"Yes, Delete",callbackFunction:function(){cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doDeleteLotOccupancy`,{lotOccupancyId:l},e=>{var t;const n=e;n.success?(u(),window.location.href=a.getLotOccupancyURL()):bulmaJS.alert({title:"Error Deleting Record",message:null!==(t=n.errorMessage)&&void 0!==t?t:"",contextualColorName:"danger"})})}}})}),null===(t=document.querySelector("#button--createWorkOrder"))||void 0===t||t.addEventListener("click",e=>{let t;function n(e){e.preventDefault(),cityssm.postJSON(`${a.urlPrefix}/workOrders/doCreateWorkOrder`,e.currentTarget,e=>{const n=e;n.success?(t(),bulmaJS.confirm({title:"Work Order Created Successfully",message:"Would you like to open the work order now?",contextualColorName:"success",okButton:{text:"Yes, Open the Work Order",callbackFunction:()=>{window.location.href=a.getWorkOrderURL(n.workOrderId,!0)}}})):bulmaJS.alert({title:"Error Creating Work Order",message:n.errorMessage,contextualColorName:"danger"})})}e.preventDefault(),cityssm.openHtmlModal("lotOccupancy-createWorkOrder",{onshow(e){var t;e.querySelector("#workOrderCreate--lotOccupancyId").value=l,e.querySelector("#workOrderCreate--workOrderOpenDateString").value=cityssm.dateToString(new Date);const n=e.querySelector("#workOrderCreate--workOrderTypeId"),c=exports.workOrderTypes;1===c.length&&(n.innerHTML="");for(const e of c){const c=document.createElement("option");c.value=e.workOrderTypeId.toString(),c.textContent=null!==(t=e.workOrderType)&&void 0!==t?t:"",n.append(c)}},onshown(e,c){var o;t=c,bulmaJS.toggleHtmlClipped(),e.querySelector("#workOrderCreate--workOrderTypeId").focus(),null===(o=e.querySelector("form"))||void 0===o||o.addEventListener("submit",n)},onremoved(){bulmaJS.toggleHtmlClipped(),document.querySelector("#button--createWorkOrder").focus()}})});const y=document.querySelector("#lotOccupancy--occupancyTypeId");if(s){const e=document.querySelector("#container--lotOccupancyFields");y.addEventListener("change",()=>{""!==y.value?cityssm.postJSON(a.urlPrefix+"/lotOccupancies/doGetOccupancyTypeFields",{occupancyTypeId:y.value},t=>{var n,c;const o=t;if(0===o.occupancyTypeFields.length)return void(e.innerHTML=`<div class="message is-info">\n              <p class="message-body">There are no additional fields for this ${a.escapedAliases.occupancy} type.</p>\n              </div>`);e.innerHTML="";let l="";for(const t of o.occupancyTypeFields){l+=","+t.occupancyTypeFieldId.toString();const o=`lotOccupancyFieldValue_${t.occupancyTypeFieldId.toString()}`,a=`lotOccupancy--${o}`,s=document.createElement("div");if(s.className="field",s.innerHTML=`<label class="label" for="${cityssm.escapeHTML(a)}"></label><div class="control"></div>`,s.querySelector("label").textContent=t.occupancyTypeField,""===(null!==(n=t.occupancyTypeFieldValues)&&void 0!==n?n:"")){const e=document.createElement("input");e.className="input",e.id=a,e.name=o,e.type="text",e.required=t.isRequired,e.minLength=t.minimumLength,e.maxLength=t.maximumLength,""!==(null!==(c=t.pattern)&&void 0!==c?c:"")&&(e.pattern=t.pattern),s.querySelector(".control").append(e)}else{s.querySelector(".control").innerHTML=`<div class="select is-fullwidth">\n                  <select id="${cityssm.escapeHTML(a)}" name="${cityssm.escapeHTML(o)}">\n                  <option value="">(Not Set)</option>\n                  </select>\n                  </div>`;const e=s.querySelector("select");e.required=t.isRequired;const n=t.occupancyTypeFieldValues.split("\n");for(const t of n){const n=document.createElement("option");n.value=t,n.textContent=t,e.append(n)}}console.log(s),e.append(s)}e.insertAdjacentHTML("beforeend",`<input name="occupancyTypeFieldIds" type="hidden"\n              value="${cityssm.escapeHTML(l.slice(1))}" />`)}):e.innerHTML=`<div class="message is-info">\n          <p class="message-body">Select the ${a.escapedAliases.occupancy} type to load the available fields.</p>\n          </div>`})}else{const e=y.value;y.addEventListener("change",()=>{y.value!==e&&bulmaJS.confirm({title:"Confirm Change",message:`Are you sure you want to change the ${a.escapedAliases.occupancy} type?\n\n            This change affects the additional fields associated with this record, and may also affect the available fees.`,contextualColorName:"warning",okButton:{text:"Yes, Keep the Change",callbackFunction:()=>{i=!0}},cancelButton:{text:"Revert the Change",callbackFunction:()=>{y.value=e}}})})}const v=document.querySelector("#lotOccupancy--lotName");v.addEventListener("click",e=>{const t=e.currentTarget.value;let n,c,o,l;function s(e,t){document.querySelector("#lotOccupancy--lotId").value=e.toString(),document.querySelector("#lotOccupancy--lotName").value=t,r(),n()}function i(e){var t,n;e.preventDefault();const c=e.currentTarget;s(null!==(t=c.dataset.lotId)&&void 0!==t?t:"",null!==(n=c.dataset.lotName)&&void 0!==n?n:"")}function u(){l.innerHTML=a.getLoadingParagraphHTML("Searching..."),cityssm.postJSON(`${a.urlPrefix}/lots/doSearchLots`,o,e=>{var t,n;const c=e;if(0===c.count)return void(l.innerHTML='<div class="message is-info">\n              <p class="message-body">No results.</p>\n              </div>');const o=document.createElement("div");o.className="panel";for(const e of c.lots){const c=document.createElement("a");c.className="panel-block is-block",c.href="#",c.dataset.lotId=e.lotId.toString(),c.dataset.lotName=e.lotName,c.innerHTML=`<div class="columns">\n              <div class="column">\n                ${cityssm.escapeHTML(null!==(t=e.lotName)&&void 0!==t?t:"")}<br />\n                <span class="is-size-7">${cityssm.escapeHTML(null!==(n=e.mapName)&&void 0!==n?n:"")}</span>\n              </div>\n              <div class="column">\n                ${cityssm.escapeHTML(e.lotStatus)}<br />\n                <span class="is-size-7">\n                  ${e.lotOccupancyCount>0?"Currently Occupied":""}\n                </span>\n              </div>\n              </div>`,c.addEventListener("click",i),o.append(c)}l.innerHTML="",l.append(o)})}function d(e){e.preventDefault();const t=c.querySelector("#lotCreate--lotName").value;cityssm.postJSON(`${a.urlPrefix}/lots/doCreateLot`,e.currentTarget,e=>{var n;const c=e;c.success?s(c.lotId,t):bulmaJS.alert({title:`Error Creating ${a.escapedAliases.Lot}`,message:null!==(n=c.errorMessage)&&void 0!==n?n:"",contextualColorName:"danger"})})}cityssm.openHtmlModal("lotOccupancy-selectLot",{onshow(e){a.populateAliases(e)},onshown(e,a){var s;bulmaJS.toggleHtmlClipped(),c=e,n=a,bulmaJS.init(e);const i=e.querySelector("#lotSelect--lotName");""!==document.querySelector("#lotOccupancy--lotId").value&&(i.value=t),i.focus(),i.addEventListener("change",u);const r=e.querySelector("#lotSelect--occupancyStatus");if(r.addEventListener("change",u),""!==t&&(r.value=""),o=e.querySelector("#form--lotSelect"),l=e.querySelector("#resultsContainer--lotSelect"),o.addEventListener("submit",e=>{e.preventDefault()}),u(),exports.lotNamePattern){const t=exports.lotNamePattern;e.querySelector("#lotCreate--lotName").pattern=t.source}const p=e.querySelector("#lotCreate--lotTypeId");for(const e of exports.lotTypes){const t=document.createElement("option");t.value=e.lotTypeId.toString(),t.textContent=e.lotType,p.append(t)}const m=e.querySelector("#lotCreate--lotStatusId");for(const e of exports.lotStatuses){const t=document.createElement("option");t.value=e.lotStatusId.toString(),t.textContent=e.lotStatus,m.append(t)}const y=e.querySelector("#lotCreate--mapId");for(const e of exports.maps){const t=document.createElement("option");t.value=e.mapId.toString(),t.textContent=""===(null!==(s=e.mapName)&&void 0!==s?s:"")?"(No Name)":e.mapName,y.append(t)}e.querySelector("#form--lotCreate").addEventListener("submit",d)},onremoved(){bulmaJS.toggleHtmlClipped()}})}),null===(n=document.querySelector(".is-lot-view-button"))||void 0===n||n.addEventListener("click",()=>{const e=document.querySelector("#lotOccupancy--lotId").value;""===e?bulmaJS.alert({message:`No ${a.escapedAliases.lot} selected.`,contextualColorName:"info"}):window.open(a.urlPrefix+"/lots/"+e)}),null===(c=document.querySelector(".is-clear-lot-button"))||void 0===c||c.addEventListener("click",()=>{v.disabled?bulmaJS.alert({message:"You need to unlock the field before clearing it.",contextualColorName:"info"}):(v.value=`(No ${a.escapedAliases.Lot})`,document.querySelector("#lotOccupancy--lotId").value="",r())}),a.initializeDatePickers(d),null===(o=document.querySelector("#lotOccupancy--occupancyStartDateString"))||void 0===o||o.addEventListener("change",()=>{const e=document.querySelector("#lotOccupancy--occupancyEndDateString").bulmaCalendar.datePicker;e.min=document.querySelector("#lotOccupancy--occupancyStartDateString").value,e.refresh()}),a.initializeUnlockFieldButtons(d),Object.defineProperty(exports,"__esModule",{value:!0});let f=exports.lotOccupancyOccupants;function O(e){var t,n;const c=Number.parseInt(null!==(n=null===(t=e.currentTarget.closest("tr"))||void 0===t?void 0:t.dataset.lotOccupantIndex)&&void 0!==n?n:"",10),o=f.find(e=>e.lotOccupantIndex===c);let s,i;function r(e){e.preventDefault(),cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doUpdateLotOccupancyOccupant`,s,e=>{var t;const n=e;n.success?(f=n.lotOccupancyOccupants,i(),h()):bulmaJS.alert({title:`Error Updating ${a.escapedAliases.Occupant}`,message:null!==(t=n.errorMessage)&&void 0!==t?t:"",contextualColorName:"danger"})})}cityssm.openHtmlModal("lotOccupancy-editOccupant",{onshow(e){var t,n,s,i,r,u,d,p,m,y,v,f,O,g,h,S;a.populateAliases(e),e.querySelector("#lotOccupancyOccupantEdit--lotOccupancyId").value=l,e.querySelector("#lotOccupancyOccupantEdit--lotOccupantIndex").value=c.toString();const b=e.querySelector("#lotOccupancyOccupantEdit--lotOccupantTypeId");let C=!1;for(const e of exports.lotOccupantTypes){const t=document.createElement("option");t.value=e.lotOccupantTypeId.toString(),t.textContent=e.lotOccupantType,t.dataset.occupantCommentTitle=e.occupantCommentTitle,t.dataset.fontAwesomeIconClass=e.fontAwesomeIconClass,e.lotOccupantTypeId===o.lotOccupantTypeId&&(t.selected=!0,C=!0),b.append(t)}if(!C){const e=document.createElement("option");e.value=null!==(n=null===(t=o.lotOccupantTypeId)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",e.textContent=null!==(s=o.lotOccupantType)&&void 0!==s?s:"",e.dataset.occupantCommentTitle=o.occupantCommentTitle,e.dataset.fontAwesomeIconClass=o.fontAwesomeIconClass,e.selected=!0,b.append(e)}e.querySelector("#lotOccupancyOccupantEdit--fontAwesomeIconClass").innerHTML=`<i class="fas fa-fw fa-${cityssm.escapeHTML(null!==(i=o.fontAwesomeIconClass)&&void 0!==i?i:"")}" aria-hidden="true"></i>`,e.querySelector("#lotOccupancyOccupantEdit--occupantName").value=null!==(r=o.occupantName)&&void 0!==r?r:"",e.querySelector("#lotOccupancyOccupantEdit--occupantFamilyName").value=null!==(u=o.occupantFamilyName)&&void 0!==u?u:"",e.querySelector("#lotOccupancyOccupantEdit--occupantAddress1").value=null!==(d=o.occupantAddress1)&&void 0!==d?d:"",e.querySelector("#lotOccupancyOccupantEdit--occupantAddress2").value=null!==(p=o.occupantAddress2)&&void 0!==p?p:"",e.querySelector("#lotOccupancyOccupantEdit--occupantCity").value=null!==(m=o.occupantCity)&&void 0!==m?m:"",e.querySelector("#lotOccupancyOccupantEdit--occupantProvince").value=null!==(y=o.occupantProvince)&&void 0!==y?y:"",e.querySelector("#lotOccupancyOccupantEdit--occupantPostalCode").value=null!==(v=o.occupantPostalCode)&&void 0!==v?v:"",e.querySelector("#lotOccupancyOccupantEdit--occupantPhoneNumber").value=null!==(f=o.occupantPhoneNumber)&&void 0!==f?f:"",e.querySelector("#lotOccupancyOccupantEdit--occupantEmailAddress").value=null!==(O=o.occupantEmailAddress)&&void 0!==O?O:"",e.querySelector("#lotOccupancyOccupantEdit--occupantCommentTitle").textContent=""===(null!==(g=o.occupantCommentTitle)&&void 0!==g?g:"")?"Comment":null!==(h=o.occupantCommentTitle)&&void 0!==h?h:"",e.querySelector("#lotOccupancyOccupantEdit--occupantComment").value=null!==(S=o.occupantComment)&&void 0!==S?S:""},onshown(e,t){bulmaJS.toggleHtmlClipped();const n=e.querySelector("#lotOccupancyOccupantEdit--lotOccupantTypeId");n.focus(),n.addEventListener("change",()=>{var t,c;const o=null!==(t=n.selectedOptions[0].dataset.fontAwesomeIconClass)&&void 0!==t?t:"user";e.querySelector("#lotOccupancyOccupantEdit--fontAwesomeIconClass").innerHTML=`<i class="fas fa-fw fa-${cityssm.escapeHTML(o)}" aria-hidden="true"></i>`;let a=null!==(c=n.selectedOptions[0].dataset.occupantCommentTitle)&&void 0!==c?c:"";""===a&&(a="Comment"),e.querySelector("#lotOccupancyOccupantEdit--occupantCommentTitle").textContent=a}),(s=e.querySelector("form")).addEventListener("submit",r),i=t},onremoved(){bulmaJS.toggleHtmlClipped()}})}function g(e){var t;const n=null===(t=e.currentTarget.closest("tr"))||void 0===t?void 0:t.dataset.lotOccupantIndex;bulmaJS.confirm({title:`Remove ${a.escapedAliases.Occupant}?`,message:`Are you sure you want to remove this ${a.escapedAliases.occupant}?`,okButton:{text:`Yes, Remove ${a.escapedAliases.Occupant}`,callbackFunction:function(){cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doDeleteLotOccupancyOccupant`,{lotOccupancyId:l,lotOccupantIndex:n},e=>{var t;const n=e;n.success?(f=n.lotOccupancyOccupants,h()):bulmaJS.alert({title:`Error Removing ${a.escapedAliases.Occupant}`,message:null!==(t=n.errorMessage)&&void 0!==t?t:"",contextualColorName:"danger"})})}},contextualColorName:"warning"})}function h(){var e,t,n,c,o,l,s,i,r,u,d,p,m,y,v,h,S,b,C,T,x,L,q;const N=document.querySelector("#container--lotOccupancyOccupants");if(cityssm.clearElement(N),0===f.length)return void(N.innerHTML=`<div class="message is-warning">\n            <p class="message-body">There are no ${a.escapedAliases.occupants} associated with this record.</p>\n            </div>`);const E=document.createElement("table");E.className="table is-fullwidth is-striped is-hoverable",E.innerHTML=`<thead><tr>\n          <th>${a.escapedAliases.Occupant}</th>\n          <th>Address</th>\n          <th>Other Contact</th>\n          <th>Comment</th>\n          <th class="is-hidden-print"><span class="is-sr-only">Options</span></th>\n          </tr></thead>\n          <tbody></tbody>`;for(const N of f){const f=document.createElement("tr");f.dataset.lotOccupantIndex=null===(e=N.lotOccupantIndex)||void 0===e?void 0:e.toString(),f.innerHTML=`<td>\n            ${cityssm.escapeHTML(""===(null!==(t=N.occupantName)&&void 0!==t?t:"")&&""===(null!==(n=N.occupantFamilyName)&&void 0!==n?n:"")?"(No Name)":`${N.occupantName} ${N.occupantFamilyName}`)}<br />\n            <span class="tag">\n              <i class="fas fa-fw fa-${cityssm.escapeHTML(null!==(c=N.fontAwesomeIconClass)&&void 0!==c?c:"")}" aria-hidden="true"></i>\n              <span class="ml-1">${cityssm.escapeHTML(null!==(o=N.lotOccupantType)&&void 0!==o?o:"")}</span>\n            </span>\n          </td><td>\n            ${""===(null!==(l=N.occupantAddress1)&&void 0!==l?l:"")?"":cityssm.escapeHTML(null!==(s=N.occupantAddress1)&&void 0!==s?s:"")+"<br />"}\n            ${""===(null!==(i=N.occupantAddress2)&&void 0!==i?i:"")?"":cityssm.escapeHTML(null!==(r=N.occupantAddress2)&&void 0!==r?r:"")+"<br />"}\n            ${""===(null!==(u=N.occupantCity)&&void 0!==u?u:"")?"":cityssm.escapeHTML(null!==(d=N.occupantCity)&&void 0!==d?d:"")+", "}\n            ${cityssm.escapeHTML(null!==(p=N.occupantProvince)&&void 0!==p?p:"")}<br />\n            ${cityssm.escapeHTML(null!==(m=N.occupantPostalCode)&&void 0!==m?m:"")}</td><td>${""===(null!==(y=N.occupantPhoneNumber)&&void 0!==y?y:"")?"":cityssm.escapeHTML(null!==(v=N.occupantPhoneNumber)&&void 0!==v?v:"")+"<br />"}\n            ${""===(null!==(h=N.occupantEmailAddress)&&void 0!==h?h:"")?"":cityssm.escapeHTML(null!==(S=N.occupantEmailAddress)&&void 0!==S?S:"")}\n          </td><td>\n            <span data-tooltip="${cityssm.escapeHTML(""===(null!==(b=N.occupantCommentTitle)&&void 0!==b?b:"")?"Comment":null!==(C=N.occupantCommentTitle)&&void 0!==C?C:"")}">\n            ${cityssm.escapeHTML(null!==(T=N.occupantComment)&&void 0!==T?T:"")}\n            </span>\n          </td><td class="is-hidden-print">\n            <div class="buttons are-small is-justify-content-end">\n              <button class="button is-primary button--edit" type="button">\n                <span class="icon is-small"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span>\n                <span>Edit</span>\n              </button>\n              <button class="button is-light is-danger button--delete" data-tooltip="Delete ${a.escapedAliases.Occupant}" type="button" aria-label="Delete">\n                <i class="fas fa-trash" aria-hidden="true"></i>\n              </button>\n            </div>\n          </td>`,null===(x=f.querySelector(".button--edit"))||void 0===x||x.addEventListener("click",O),null===(L=f.querySelector(".button--delete"))||void 0===L||L.addEventListener("click",g),null===(q=E.querySelector("tbody"))||void 0===q||q.append(f)}N.append(E)}if(delete exports.lotOccupancyOccupants,s){const e=document.querySelector("#lotOccupancy--lotOccupantTypeId");e.addEventListener("change",()=>{var t;const n=d.querySelectorAll("[data-table='LotOccupancyOccupant']");for(const t of n)t.disabled=""===e.value;let c=null!==(t=e.selectedOptions[0].dataset.occupantCommentTitle)&&void 0!==t?t:"";""===c&&(c="Comment"),d.querySelector("#lotOccupancy--occupantCommentTitle").textContent=c})}else h();if(null===(S=document.querySelector("#button--addOccupant"))||void 0===S||S.addEventListener("click",()=>{let e,t,n,c;function o(t){cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doAddLotOccupancyOccupant`,t,t=>{var n;const c=t;c.success?(f=c.lotOccupancyOccupants,e(),h()):bulmaJS.alert({title:`Error Adding ${a.escapedAliases.Occupant}`,message:null!==(n=c.errorMessage)&&void 0!==n?n:"",contextualColorName:"danger"})})}function s(e){e.preventDefault(),o(t)}let i=[];function r(e){var t,n;e.preventDefault();const c=e.currentTarget,s=i[Number.parseInt(null!==(t=c.dataset.index)&&void 0!==t?t:"",10)],r=(null===(n=c.closest(".modal"))||void 0===n?void 0:n.querySelector("#lotOccupancyOccupantCopy--lotOccupantTypeId")).value;""===r?bulmaJS.alert({title:`No ${a.escapedAliases.Occupant} Type Selected`,message:`Select a type to apply to the newly added ${a.escapedAliases.occupant}.`,contextualColorName:"warning"}):(s.lotOccupantTypeId=Number.parseInt(r,10),s.lotOccupancyId=Number.parseInt(l,10),o(s))}function u(e){e.preventDefault(),""!==n.querySelector("#lotOccupancyOccupantCopy--searchFilter").value?(c.innerHTML=a.getLoadingParagraphHTML("Searching..."),cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doSearchPastOccupants`,n,e=>{var t,n,o,a,l,s,u,d,p,m,y;i=e.occupants;const v=document.createElement("div");v.className="panel";for(const[e,c]of i.entries()){const i=document.createElement("a");i.className="panel-block is-block",i.href="#",i.dataset.index=e.toString(),i.innerHTML=`<strong>\n                    ${cityssm.escapeHTML(null!==(t=c.occupantName)&&void 0!==t?t:"")} ${cityssm.escapeHTML(null!==(n=c.occupantFamilyName)&&void 0!==n?n:"")}\n                  </strong><br />\n                  <div class="columns">\n                    <div class="column">\n                      ${cityssm.escapeHTML(null!==(o=c.occupantAddress1)&&void 0!==o?o:"")}<br />\n                      ${""===(null!==(a=c.occupantAddress2)&&void 0!==a?a:"")?"":cityssm.escapeHTML(null!==(l=c.occupantAddress2)&&void 0!==l?l:"")+"<br />"}${cityssm.escapeHTML(null!==(s=c.occupantCity)&&void 0!==s?s:"")}, ${cityssm.escapeHTML(null!==(u=c.occupantProvince)&&void 0!==u?u:"")}<br />\n                      ${cityssm.escapeHTML(null!==(d=c.occupantPostalCode)&&void 0!==d?d:"")}\n                    </div>\n                    <div class="column">\n                    ${""===(null!==(p=c.occupantPhoneNumber)&&void 0!==p?p:"")?"":cityssm.escapeHTML(null!==(m=c.occupantPhoneNumber)&&void 0!==m?m:"")+"<br />"}\n                    ${cityssm.escapeHTML(null!==(y=c.occupantEmailAddress)&&void 0!==y?y:"")}<br />\n                    </div>\n                    </div>`,i.addEventListener("click",r),v.append(i)}c.innerHTML="",c.append(v)})):c.innerHTML='<div class="message is-info">\n              <p class="message-body">Enter a partial name or address in the search field above.</p>\n              </div>'}cityssm.openHtmlModal("lotOccupancy-addOccupant",{onshow(e){a.populateAliases(e),e.querySelector("#lotOccupancyOccupantAdd--lotOccupancyId").value=l;const t=e.querySelector("#lotOccupancyOccupantAdd--lotOccupantTypeId"),n=e.querySelector("#lotOccupancyOccupantCopy--lotOccupantTypeId");for(const e of exports.lotOccupantTypes){const c=document.createElement("option");c.value=e.lotOccupantTypeId.toString(),c.textContent=e.lotOccupantType,c.dataset.occupantCommentTitle=e.occupantCommentTitle,c.dataset.fontAwesomeIconClass=e.fontAwesomeIconClass,t.append(c),n.append(c.cloneNode(!0))}e.querySelector("#lotOccupancyOccupantAdd--occupantCity").value=exports.occupantCityDefault,e.querySelector("#lotOccupancyOccupantAdd--occupantProvince").value=exports.occupantProvinceDefault},onshown(o,a){bulmaJS.toggleHtmlClipped(),bulmaJS.init(o);const l=o.querySelector("#lotOccupancyOccupantAdd--lotOccupantTypeId");l.focus(),l.addEventListener("change",()=>{var e,t;const n=null!==(e=l.selectedOptions[0].dataset.fontAwesomeIconClass)&&void 0!==e?e:"user";o.querySelector("#lotOccupancyOccupantAdd--fontAwesomeIconClass").innerHTML=`<i class="fas fa-fw fa-${cityssm.escapeHTML(n)}" aria-hidden="true"></i>`;let c=null!==(t=l.selectedOptions[0].dataset.occupantCommentTitle)&&void 0!==t?t:"";""===c&&(c="Comment"),o.querySelector("#lotOccupancyOccupantAdd--occupantCommentTitle").textContent=c}),(t=o.querySelector("#form--lotOccupancyOccupantAdd")).addEventListener("submit",s),c=o.querySelector("#lotOccupancyOccupantCopy--searchResults"),(n=o.querySelector("#form--lotOccupancyOccupantCopy")).addEventListener("submit",e=>{e.preventDefault()}),o.querySelector("#lotOccupancyOccupantCopy--searchFilter").addEventListener("change",u),e=a},onremoved(){bulmaJS.toggleHtmlClipped(),document.querySelector("#button--addOccupant").focus()}})}),!s){var S;Object.defineProperty(exports,"__esModule",{value:!0});let e=exports.lotOccupancyComments;function b(t){var n,c;const o=Number.parseInt(null!==(c=null===(n=t.currentTarget.closest("tr"))||void 0===n?void 0:n.dataset.lotOccupancyCommentId)&&void 0!==c?c:"",10),s=e.find(e=>e.lotOccupancyCommentId===o);let i,r;function u(t){t.preventDefault(),cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doUpdateLotOccupancyComment`,i,t=>{var n,c;const o=t;o.success?(e=null!==(n=o.lotOccupancyComments)&&void 0!==n?n:[],r(),T()):bulmaJS.alert({title:"Error Updating Comment",message:null!==(c=o.errorMessage)&&void 0!==c?c:"",contextualColorName:"danger"})})}cityssm.openHtmlModal("lotOccupancy-editComment",{onshow(e){var t,n,c,i;a.populateAliases(e),e.querySelector("#lotOccupancyCommentEdit--lotOccupancyId").value=l,e.querySelector("#lotOccupancyCommentEdit--lotOccupancyCommentId").value=o.toString(),e.querySelector("#lotOccupancyCommentEdit--lotOccupancyComment").value=null!==(t=s.lotOccupancyComment)&&void 0!==t?t:"";const r=e.querySelector("#lotOccupancyCommentEdit--lotOccupancyCommentDateString");r.value=null!==(n=s.lotOccupancyCommentDateString)&&void 0!==n?n:"";const u=cityssm.dateToString(new Date);r.max=s.lotOccupancyCommentDateString<=u?u:null!==(c=s.lotOccupancyCommentDateString)&&void 0!==c?c:"",e.querySelector("#lotOccupancyCommentEdit--lotOccupancyCommentTimeString").value=null!==(i=s.lotOccupancyCommentTimeString)&&void 0!==i?i:""},onshown(e,t){bulmaJS.toggleHtmlClipped(),a.initializeDatePickers(e),e.querySelector("#lotOccupancyCommentEdit--lotOccupancyComment").focus(),(i=e.querySelector("form")).addEventListener("submit",u),r=t},onremoved(){bulmaJS.toggleHtmlClipped()}})}function C(t){var n,c;const o=Number.parseInt(null!==(c=null===(n=t.currentTarget.closest("tr"))||void 0===n?void 0:n.dataset.lotOccupancyCommentId)&&void 0!==c?c:"",10);bulmaJS.confirm({title:"Remove Comment?",message:"Are you sure you want to remove this comment?",okButton:{text:"Yes, Remove Comment",callbackFunction:function(){cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doDeleteLotOccupancyComment`,{lotOccupancyId:l,lotOccupancyCommentId:o},t=>{var n;const c=t;c.success?(e=c.lotOccupancyComments,T()):bulmaJS.alert({title:"Error Removing Comment",message:null!==(n=c.errorMessage)&&void 0!==n?n:"",contextualColorName:"danger"})})}},contextualColorName:"warning"})}function T(){var t,n,c,o,a,l,s,i;const r=document.querySelector("#container--lotOccupancyComments");if(0===e.length)return void(r.innerHTML='<div class="message is-info">\n              <p class="message-body">There are no comments associated with this record.</p>\n              </div>');const u=document.createElement("table");u.className="table is-fullwidth is-striped is-hoverable",u.innerHTML='<thead><tr>\n            <th>Commentor</th>\n            <th>Comment Date</th>\n            <th>Comment</th>\n            <th class="is-hidden-print"><span class="is-sr-only">Options</span></th>\n            </tr></thead>\n            <tbody></tbody>';for(const r of e){const e=document.createElement("tr");e.dataset.lotOccupancyCommentId=null===(t=r.lotOccupancyCommentId)||void 0===t?void 0:t.toString(),e.innerHTML=`<td>${cityssm.escapeHTML(null!==(n=r.recordCreate_userName)&&void 0!==n?n:"")}</td>\n              <td>\n              ${cityssm.escapeHTML(null!==(c=r.lotOccupancyCommentDateString)&&void 0!==c?c:"")}\n              ${cityssm.escapeHTML(0===r.lotOccupancyCommentTime?"":null!==(o=r.lotOccupancyCommentTimePeriodString)&&void 0!==o?o:"")}\n              </td>\n              <td>${cityssm.escapeHTML(null!==(a=r.lotOccupancyComment)&&void 0!==a?a:"")}</td>\n              <td class="is-hidden-print">\n                <div class="buttons are-small is-justify-content-end">\n                <button class="button is-primary button--edit" type="button">\n                  <span class="icon is-small"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span>\n                  <span>Edit</span>\n                </button>\n                <button class="button is-light is-danger button--delete" data-tooltip="Delete Comment" type="button" aria-label="Delete">\n                  <i class="fas fa-trash" aria-hidden="true"></i>\n                </button>\n                </div>\n              </td>`,null===(l=e.querySelector(".button--edit"))||void 0===l||l.addEventListener("click",b),null===(s=e.querySelector(".button--delete"))||void 0===s||s.addEventListener("click",C),null===(i=u.querySelector("tbody"))||void 0===i||i.append(e)}r.innerHTML="",r.append(u)}delete exports.lotOccupancyComments,null===(S=document.querySelector("#button--addComment"))||void 0===S||S.addEventListener("click",()=>{let t,n;function c(c){c.preventDefault(),cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doAddLotOccupancyComment`,t,t=>{var c;const o=t;o.success?(e=o.lotOccupancyComments,n(),T()):bulmaJS.alert({title:"Error Adding Comment",message:null!==(c=o.errorMessage)&&void 0!==c?c:"",contextualColorName:"danger"})})}cityssm.openHtmlModal("lotOccupancy-addComment",{onshow(e){a.populateAliases(e),e.querySelector("#lotOccupancyCommentAdd--lotOccupancyId").value=l},onshown(e,o){bulmaJS.toggleHtmlClipped(),e.querySelector("#lotOccupancyCommentAdd--lotOccupancyComment").focus(),(t=e.querySelector("form")).addEventListener("submit",c),n=o},onremoved:()=>{bulmaJS.toggleHtmlClipped(),document.querySelector("#button--addComment").focus()}})}),T(),Object.defineProperty(exports,"__esModule",{value:!0});let t=exports.lotOccupancyFees;delete exports.lotOccupancyFees;const n=document.querySelector("#container--lotOccupancyFees");function x(){var e,n,c;let o=0;for(const a of t)o+=((null!==(e=a.feeAmount)&&void 0!==e?e:0)+(null!==(n=a.taxAmount)&&void 0!==n?n:0))*(null!==(c=a.quantity)&&void 0!==c?c:0);return o}function L(e){var n,c;const o=Number.parseInt(null!==(c=null===(n=e.currentTarget.closest("tr"))||void 0===n?void 0:n.dataset.feeId)&&void 0!==c?c:"",10),s=t.find(e=>e.feeId===o);let i;function r(e){e.preventDefault(),cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doUpdateLotOccupancyFeeQuantity`,e.currentTarget,e=>{const n=e;n.success?(t=n.lotOccupancyFees,N(),i()):bulmaJS.alert({title:"Error Updating Quantity",message:"Please try again.",contextualColorName:"danger"})})}cityssm.openHtmlModal("lotOccupancy-editFeeQuantity",{onshow(e){var t,n;e.querySelector("#lotOccupancyFeeQuantity--lotOccupancyId").value=l,e.querySelector("#lotOccupancyFeeQuantity--feeId").value=s.feeId.toString(),e.querySelector("#lotOccupancyFeeQuantity--quantity").valueAsNumber=null!==(t=s.quantity)&&void 0!==t?t:0,e.querySelector("#lotOccupancyFeeQuantity--quantityUnit").textContent=null!==(n=s.quantityUnit)&&void 0!==n?n:""},onshown(e,t){var n;bulmaJS.toggleHtmlClipped(),i=t,e.querySelector("#lotOccupancyFeeQuantity--quantity").focus(),null===(n=e.querySelector("form"))||void 0===n||n.addEventListener("submit",r)},onremoved(){bulmaJS.toggleHtmlClipped()}})}function q(e){const n=e.currentTarget.closest(".container--lotOccupancyFee").dataset.feeId;bulmaJS.confirm({title:"Delete Fee",message:"Are you sure you want to delete this fee?",contextualColorName:"warning",okButton:{text:"Yes, Delete Fee",callbackFunction:function(){cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doDeleteLotOccupancyFee`,{lotOccupancyId:l,feeId:n},e=>{var n;const c=e;c.success?(t=c.lotOccupancyFees,N()):bulmaJS.alert({title:"Error Deleting Fee",message:null!==(n=c.errorMessage)&&void 0!==n?n:"",contextualColorName:"danger"})})}}})}function N(){var e,c,o,a,l,s,i,r,u,d,p,m,y,v,f;if(0===t.length)return n.innerHTML='<div class="message is-info">\n                <p class="message-body">There are no fees associated with this record.</p>\n                </div>',void I();n.innerHTML='<table class="table is-fullwidth is-striped is-hoverable">\n              <thead><tr>\n                <th>Fee</th>\n                <th><span class="is-sr-only">Unit Cost</span></th>\n                <th class="has-width-1"><span class="is-sr-only">&times;</span></th>\n                <th class="has-width-1"><span class="is-sr-only">Quantity</span></th>\n                <th class="has-width-1"><span class="is-sr-only">equals</span></th>\n                <th class="has-width-1 has-text-right">Total</th>\n                <th class="has-width-1 is-hidden-print"><span class="is-sr-only">Options</span></th>\n              </tr></thead>\n              <tbody></tbody>\n              <tfoot><tr>\n                <th colspan="5">Subtotal</th>\n                <td class="has-text-weight-bold has-text-right" id="lotOccupancyFees--feeAmountTotal"></td>\n                <td class="is-hidden-print"></td>\n              </tr><tr>\n                <th colspan="5">Tax</th>\n                <td class="has-text-right" id="lotOccupancyFees--taxAmountTotal"></td>\n                <td class="is-hidden-print"></td>\n              </tr><tr>\n                <th colspan="5">Grand Total</th>\n                <td class="has-text-weight-bold has-text-right" id="lotOccupancyFees--grandTotal"></td>\n                <td class="is-hidden-print"></td>\n              </tr></tfoot></table>';let O=0,g=0;for(const h of t){const t=document.createElement("tr");t.className="container--lotOccupancyFee",t.dataset.feeId=h.feeId.toString(),t.dataset.includeQuantity=null!==(e=h.includeQuantity)&&void 0!==e&&e?"1":"0",t.innerHTML=`<td colspan="${1===h.quantity?"5":"1"}">\n              ${cityssm.escapeHTML(null!==(c=h.feeName)&&void 0!==c?c:"")}<br />\n              <span class="tag">${cityssm.escapeHTML(null!==(o=h.feeCategory)&&void 0!==o?o:"")}</span>\n              </td>\n              ${1===h.quantity?"":`<td class="has-text-right">\n                      $${null===(a=h.feeAmount)||void 0===a?void 0:a.toFixed(2)}\n                      </td>\n                      <td>&times;</td>\n                      <td class="has-text-right">${null===(l=h.quantity)||void 0===l?void 0:l.toString()}</td>\n                      <td>=</td>`}\n              <td class="has-text-right">\n                $${((null!==(s=h.feeAmount)&&void 0!==s?s:0)*(null!==(i=h.quantity)&&void 0!==i?i:0)).toFixed(2)}\n              </td>\n              <td class="is-hidden-print">\n              <div class="buttons are-small is-flex-wrap-nowrap is-justify-content-end">\n              ${null!==(r=h.includeQuantity)&&void 0!==r&&r?'<button class="button is-primary button--editQuantity">\n                      <span class="icon is-small"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span>\n                      <span>Edit</span>\n                      </button>':""}\n              <button class="button is-danger is-light button--delete" data-tooltip="Delete Fee" type="button">\n                <i class="fas fa-trash" aria-hidden="true"></i>\n              </button>\n              </div>\n              </td>`,null===(u=t.querySelector(".button--editQuantity"))||void 0===u||u.addEventListener("click",L),null===(d=t.querySelector(".button--delete"))||void 0===d||d.addEventListener("click",q),null===(p=n.querySelector("tbody"))||void 0===p||p.append(t),O+=(null!==(m=h.feeAmount)&&void 0!==m?m:0)*(null!==(y=h.quantity)&&void 0!==y?y:0),g+=(null!==(v=h.taxAmount)&&void 0!==v?v:0)*(null!==(f=h.quantity)&&void 0!==f?f:0)}n.querySelector("#lotOccupancyFees--feeAmountTotal").textContent="$"+O.toFixed(2),n.querySelector("#lotOccupancyFees--taxAmountTotal").textContent="$"+g.toFixed(2),n.querySelector("#lotOccupancyFees--grandTotal").textContent="$"+(O+g).toFixed(2),I()}const c=document.querySelector("#button--addFee");c.addEventListener("click",()=>{if(a.hasUnsavedChanges())return void bulmaJS.alert({message:"Please save all unsaved changes before adding fees.",contextualColorName:"warning"});let e,o,s;function i(e,n=1){cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doAddLotOccupancyFee`,{lotOccupancyId:l,feeId:e,quantity:n},e=>{var n;const c=e;c.success?(t=c.lotOccupancyFees,N(),u()):bulmaJS.alert({title:"Error Adding Fee",message:null!==(n=c.errorMessage)&&void 0!==n?n:"",contextualColorName:"danger"})})}function r(t){var n,c,o;t.preventDefault();const a=Number.parseInt(null!==(n=t.currentTarget.dataset.feeId)&&void 0!==n?n:"",10),l=Number.parseInt(null!==(c=t.currentTarget.dataset.feeCategoryId)&&void 0!==c?c:"",10),s=e.find(e=>e.feeCategoryId===l).fees.find(e=>e.feeId===a);null!==(o=s.includeQuantity)&&void 0!==o&&o?function(e){let t,n;function c(c){c.preventDefault(),i(e.feeId,t.value),n()}cityssm.openHtmlModal("lotOccupancy-setFeeQuantity",{onshow(t){var n;t.querySelector("#lotOccupancyFeeQuantity--quantityUnit").textContent=null!==(n=e.quantityUnit)&&void 0!==n?n:""},onshown(e,o){var a;n=o,t=e.querySelector("#lotOccupancyFeeQuantity--quantity"),null===(a=e.querySelector("form"))||void 0===a||a.addEventListener("submit",c)}})}(s):i(a)}function u(){var t,c,a,l,i,u;const d=o.value.trim().toLowerCase().split(" ");s.innerHTML="";for(const o of e){const e=document.createElement("div");e.className="container--feeCategory",e.dataset.feeCategoryId=o.feeCategoryId.toString(),e.innerHTML=`<h4 class="title is-5 mt-2">${cityssm.escapeHTML(null!==(t=o.feeCategory)&&void 0!==t?t:"")}</h4>\n                <div class="panel mb-5"></div>`;let p=!1;for(const t of o.fees){if(null!==n.querySelector(`.container--lotOccupancyFee[data-fee-id='${t.feeId}'][data-include-quantity='0']`))continue;let s=!0;const m=`${null!==(c=o.feeCategory)&&void 0!==c?c:""} ${null!==(a=t.feeName)&&void 0!==a?a:""} ${null!==(l=t.feeDescription)&&void 0!==l?l:""}`.toLowerCase();for(const e of d)if(!m.includes(e)){s=!1;break}if(!s)continue;p=!0;const y=document.createElement("a");y.className="panel-block is-block container--fee",y.dataset.feeId=t.feeId.toString(),y.dataset.feeCategoryId=o.feeCategoryId.toString(),y.href="#",y.innerHTML=`<strong>${cityssm.escapeHTML(null!==(i=t.feeName)&&void 0!==i?i:"")}</strong><br />\n                  <small>\n                  ${cityssm.escapeHTML(null!==(u=t.feeDescription)&&void 0!==u?u:"").replaceAll("\n","<br />")}\n                  </small>`,y.addEventListener("click",r),e.querySelector(".panel").append(y)}p&&s.append(e)}}cityssm.openHtmlModal("lotOccupancy-addFee",{onshow(t){o=t.querySelector("#feeSelect--feeName"),s=t.querySelector("#resultsContainer--feeSelect"),cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doGetFees`,{lotOccupancyId:l},t=>{e=t.feeCategories,o.disabled=!1,o.addEventListener("keyup",u),o.focus(),u()})},onshown(){bulmaJS.toggleHtmlClipped()},onhidden(){N()},onremoved(){bulmaJS.toggleHtmlClipped(),c.focus()}})});let o=exports.lotOccupancyTransactions;delete exports.lotOccupancyTransactions;const s=document.querySelector("#container--lotOccupancyTransactions");function E(e){var t,n;const c=Number.parseInt(null!==(n=null===(t=e.currentTarget.closest("tr"))||void 0===t?void 0:t.dataset.transactionIndex)&&void 0!==n?n:"",10),s=o.find(e=>e.transactionIndex===c);let i;function r(e){e.preventDefault(),cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doUpdateLotOccupancyTransaction`,e.currentTarget,e=>{const t=e;t.success?(o=t.lotOccupancyTransactions,I(),i()):bulmaJS.alert({title:"Error Updating Transaction",message:"Please try again.",contextualColorName:"danger"})})}cityssm.openHtmlModal("lotOccupancy-editTransaction",{onshow(e){var t,n,c,o,i,r;a.populateAliases(e),e.querySelector("#lotOccupancyTransactionEdit--lotOccupancyId").value=l,e.querySelector("#lotOccupancyTransactionEdit--transactionIndex").value=null!==(n=null===(t=s.transactionIndex)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",e.querySelector("#lotOccupancyTransactionEdit--transactionAmount").value=s.transactionAmount.toFixed(2),e.querySelector("#lotOccupancyTransactionEdit--externalReceiptNumber").value=null!==(c=s.externalReceiptNumber)&&void 0!==c?c:"",e.querySelector("#lotOccupancyTransactionEdit--transactionNote").value=null!==(o=s.transactionNote)&&void 0!==o?o:"",e.querySelector("#lotOccupancyTransactionEdit--transactionDateString").value=null!==(i=s.transactionDateString)&&void 0!==i?i:"",e.querySelector("#lotOccupancyTransactionEdit--transactionTimeString").value=null!==(r=s.transactionTimeString)&&void 0!==r?r:""},onshown(e,t){var n;bulmaJS.toggleHtmlClipped(),a.initializeDatePickers(e),e.querySelector("#lotOccupancyTransactionEdit--transactionAmount").focus(),null===(n=e.querySelector("form"))||void 0===n||n.addEventListener("submit",r),i=t},onremoved(){bulmaJS.toggleHtmlClipped()}})}function M(e){const t=e.currentTarget.closest(".container--lotOccupancyTransaction").dataset.transactionIndex;bulmaJS.confirm({title:"Delete Trasnaction",message:"Are you sure you want to delete this transaction?",contextualColorName:"warning",okButton:{text:"Yes, Delete Transaction",callbackFunction:function(){cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doDeleteLotOccupancyTransaction`,{lotOccupancyId:l,transactionIndex:t},e=>{var t;const n=e;n.success?(o=n.lotOccupancyTransactions,I()):bulmaJS.alert({title:"Error Deleting Transaction",message:null!==(t=n.errorMessage)&&void 0!==t?t:"",contextualColorName:"danger"})})}}})}function I(){var e,n,c,l,i,r,u;if(0===o.length)return void(s.innerHTML=`<div class="message ${0===t.length?"is-info":"is-warning"}">\n              <p class="message-body">There are no transactions associated with this record.</p>\n              </div>`);s.innerHTML=`<table class="table is-fullwidth is-striped is-hoverable">\n              <thead><tr>\n                <th class="has-width-1">Date</th>\n                <th>${a.escapedAliases.ExternalReceiptNumber}</th>\n                <th class="has-text-right has-width-1">Amount</th>\n                <th class="has-width-1 is-hidden-print"><span class="is-sr-only">Options</span></th>\n              </tr></thead>\n              <tbody></tbody>\n              <tfoot><tr>\n                <th colspan="2">Transaction Total</th>\n                <td class="has-text-weight-bold has-text-right" id="lotOccupancyTransactions--grandTotal"></td>\n                <td class="is-hidden-print"></td>\n              </tr></tfoot>\n              </table>`;let d=0;for(const t of o){d+=t.transactionAmount;const o=document.createElement("tr");o.className="container--lotOccupancyTransaction",o.dataset.transactionIndex=null===(e=t.transactionIndex)||void 0===e?void 0:e.toString();let p="";""!==t.externalReceiptNumber&&(p=cityssm.escapeHTML(null!==(n=t.externalReceiptNumber)&&void 0!==n?n:""),a.dynamicsGPIntegrationIsEnabled&&(void 0===t.dynamicsGPDocument?p+=' <span data-tooltip="No Matching Document Found">\n                    <i class="fas fa-times-circle has-text-danger" aria-label="No Matching Document Found"></i>\n                    </span>':t.dynamicsGPDocument.documentTotal.toFixed(2)===t.transactionAmount.toFixed(2)?p+=' <span data-tooltip="Matching Document Found">\n                    <i class="fas fa-check-circle has-text-success" aria-label="Matching Document Found"></i>\n                    </span>':p+=` <span data-tooltip="Matching Document: $${t.dynamicsGPDocument.documentTotal.toFixed(2)}">\n                    <i class="fas fa-check-circle has-text-warning" aria-label="Matching Document: $${t.dynamicsGPDocument.documentTotal.toFixed(2)}"></i>\n                    </span>`),p+="<br />"),o.innerHTML=`<td>\n              ${cityssm.escapeHTML(null!==(c=t.transactionDateString)&&void 0!==c?c:"")}\n              </td>\n              <td>\n                ${p}\n                <small>${cityssm.escapeHTML(null!==(l=t.transactionNote)&&void 0!==l?l:"")}</small>\n              </td>\n              <td class="has-text-right">\n                $${cityssm.escapeHTML(t.transactionAmount.toFixed(2))}\n              </td>\n              <td class="is-hidden-print">\n                <div class="buttons are-small is-flex-wrap-nowrap is-justify-content-end">\n                  <button class="button is-primary button--edit" type="button">\n                    <span class="icon"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span>\n                    <span>Edit</span>\n                  </button>\n                  <button class="button is-danger is-light button--delete" data-tooltip="Delete Transaction" type="button">\n                    <i class="fas fa-trash" aria-hidden="true"></i>\n                  </button>\n                </div>\n              </td>`,null===(i=o.querySelector(".button--edit"))||void 0===i||i.addEventListener("click",E),null===(r=o.querySelector(".button--delete"))||void 0===r||r.addEventListener("click",M),null===(u=s.querySelector("tbody"))||void 0===u||u.append(o)}s.querySelector("#lotOccupancyTransactions--grandTotal").textContent="$"+d.toFixed(2);const p=x();p.toFixed(2)!==d.toFixed(2)&&s.insertAdjacentHTML("afterbegin",`<div class="message is-warning">\n                <div class="message-body">\n                <div class="level">\n                  <div class="level-left">\n                    <div class="level-item">Outstanding Balance</div>\n                  </div>\n                  <div class="level-right">\n                    <div class="level-item">$${cityssm.escapeHTML((p-d).toFixed(2))}</div>\n                  </div>\n                </div>\n                </div></div>`)}const i=document.querySelector("#button--addTransaction");i.addEventListener("click",()=>{let e,t,n;function c(e){e.preventDefault(),cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doAddLotOccupancyTransaction`,e.currentTarget,e=>{var t;const c=e;c.success?(o=c.lotOccupancyTransactions,n(),I()):bulmaJS.confirm({title:"Error Adding Transaction",message:null!==(t=c.errorMessage)&&void 0!==t?t:"",contextualColorName:"danger"})})}function s(){var n,c;const o=t.value,l=null===(n=t.closest(".control"))||void 0===n?void 0:n.querySelector(".icon"),s=null===(c=t.closest(".field"))||void 0===c?void 0:c.querySelector(".help");if(""===o)return s.innerHTML="&nbsp;",void(l.innerHTML='<i class="fas fa-minus" aria-hidden="true"></i>');cityssm.postJSON(`${a.urlPrefix}/lotOccupancies/doGetDynamicsGPDocument`,{externalReceiptNumber:o},t=>{const n=t;n.success&&void 0!==n.dynamicsGPDocument?e.valueAsNumber===n.dynamicsGPDocument.documentTotal?(s.textContent="Matching Document Found",l.innerHTML='<i class="fas fa-check-circle" aria-hidden="true"></i>'):(s.textContent="Matching Document: $"+n.dynamicsGPDocument.documentTotal.toFixed(2),l.innerHTML='<i class="fas fa-exclamation-triangle" aria-hidden="true"></i>'):(s.textContent="No Matching Document Found",l.innerHTML='<i class="fas fa-times-circle" aria-hidden="true"></i>')})}cityssm.openHtmlModal("lotOccupancy-addTransaction",{onshow(n){a.populateAliases(n),n.querySelector("#lotOccupancyTransactionAdd--lotOccupancyId").value=l.toString();const c=x(),i=function(){let e=0;for(const t of o)e+=t.transactionAmount;return e}();if((e=n.querySelector("#lotOccupancyTransactionAdd--transactionAmount")).min=(-1*i).toFixed(2),e.max=Math.max(c-i,0).toFixed(2),e.value=Math.max(c-i,0).toFixed(2),a.dynamicsGPIntegrationIsEnabled){const c=(t=n.querySelector("#lotOccupancyTransactionAdd--externalReceiptNumber")).closest(".control");c.classList.add("has-icons-right"),c.insertAdjacentHTML("beforeend",'<span class="icon is-small is-right"></span>'),c.insertAdjacentHTML("afterend",'<p class="help has-text-right"></p>'),t.addEventListener("change",s),e.addEventListener("change",s),s()}},onshown(t,o){var a;bulmaJS.toggleHtmlClipped(),e.focus(),n=o,null===(a=t.querySelector("form"))||void 0===a||a.addEventListener("submit",c)},onremoved(){bulmaJS.toggleHtmlClipped(),i.focus()}})}),N()}})();